{"version":3,"file":"dutier.js","sources":["../src/providers.js","../src/updateState.js","../src/setReducer.js","../src/asyncReducer.js","../src/applyHandler.js","../src/dispatch.js","../src/getState.js","../src/unsubscribe.js","../src/subscribe.js","../src/createStore.js","../src/combine.js"],"sourcesContent":["/**\n * The Providers\n */ \nexport const Provider = {\n  // The reducers\n  _reducers: new Map(),\n  // The subscribe handlers\n  _handlers: [],\n  // The state manager\n  _updateState: function(){}\n}","/**\n * Creates a Dutier store that holds the state tree.\n * The only way to change the data in the store is to call `dispatch()` on it.\n * @param { Object } state The initial application state\n * @return {Function} currentState Return a function that\n * updates and returns the current state\n */\nexport default (state) => {\n  return (\n    function(state) {\n      var state = Object.assign({}, state)\n      return current => {\n        state = Object.assign({}, state, current)\n        return state\n      }\n    }(state)\n  )\n}\n","import { Provider } from './providers'\nimport create from './updateState'\n\n/**\n * @name setReducer\n * @description Set the reducer function, the\n * initial state of the reducer and store state\n */  \nexport default reducers => {\n    // if createStore don't was called yet\n    if (Provider._updateState({}) === undefined) {\n        Provider._updateState = create({})\n    }\n    reducers.forEach( reducer => {\n        const initial = reducer(undefined, { type: '@@DUTIER.INITIAL_STATE' })\n        Provider._reducers.set(reducer, { initial } )\n        Provider._updateState(initial)\n  })\n}","import { Provider } from './providers'\n\n/**\n * Async Reducer\n * Just dispatch if return new state values.\n * With this, the subscribe function will not be\n * called unnecessary, because the state don't be changed\n */\nexport default (action) => {\n  return new Promise( ( resolve, reject ) => {\n    for (let reducer of Provider._reducers ) {\n      const reducerFunction = reducer[0]\n      const reducerProps = reducer[1]\n      const stateReducer = reducerProps.current ? reducerProps.current : reducerProps.initial\n      const current = reducerProps.current = reducerFunction(stateReducer, action)\n      if (JSON.stringify( current ) !== JSON.stringify(stateReducer)) {\n        return resolve({type: action.type, state: Provider._updateState(current) })\n      }\n    }\n  })\n}\n","import { Provider } from './providers'\n\n/**\n * Apply the subscribe handler functions\n */ \nexport default ({ type, state }) => {\n  Provider._handlers.forEach(handler => {\n    if (handler !== undefined && typeof handler === 'function') {\n      handler({ type, state })\n    }\n  })\n  return { type, state }\n}\n","import asyncReducer from './asyncReducer'\nimport applyHandler from './applyHandler'\n\n/**\n   * @name dispatch\n   * @description Dispatch an action to change\n   * the store state\n   * @param { Object } payload The action payload\n   */  \n  export default  ( payload ) => {\n    return new Promise( resolve => \n      payload.call(null, resolve )\n    ).then(asyncReducer)\n    .then(applyHandler)\n  }","import {Provider} from './providers'\n\n/**\n * @name getState\n * @return {Object} a copy of the state\n */\nexport default () => {\n  return Provider._updateState({})\n}\n","import { Provider } from './providers'\n\n/**\n * @name unsubscribe\n * @description Unsubscribes from listening to a component\n * @param {Function} handler The handler function\n **/\nexport default (handler) => {\n  Provider._handlers.forEach((fn, index) => {\n    if (fn === handler) {\n      Provider._handlers.splice(index, 1)\n    }\n  })\n}\n","import { Provider } from './providers'\nimport unsubscribe from './unsubscribe'\n\n/**\n * Subscribe to receive notifications when state is updated.\n * @name subscribe\n * @description Subscribe to call the handler function when the action will be triggered\n * @param {Function} handler The function that will be called\n **/\nexport default (handler) => {\n  Provider._handlers.push(handler)\n  return () => {\n    unsubscribe(handler)\n  }\n}\n","import { Provider } from './providers'\nimport setReducer from './setReducer'\nimport create from './updateState'\nimport dispatch from './dispatch'\nimport getState from './getState'\nimport subscribe from './subscribe'\n\n/**\n * @name createStore\n * @description Sets the store state\n * @param {Object} data Simple Object that contain the State\n * @param {Function} reducers The action reducers\n */\nexport default ( ...reducers ) => {\n  if (Provider._updateState({}) === undefined) {\n    Provider._updateState = create({})\n  }\n  setReducer(reducers)\n  return { dispatch, subscribe, getState }\n}\n","import setReducer from './setReducer'\n\n/**\n * @name combine\n * @description Combine the reducers\n */  \nexport default (...reducers) => { \n  setReducer(reducers)\n}\n"],"names":["Provider","Map","state","Object","assign","current","_updateState","undefined","create","forEach","initial","reducer","type","_reducers","set","action","Promise","resolve","reject","reducerFunction","reducerProps","stateReducer","JSON","stringify","_handlers","handler","payload","call","then","asyncReducer","applyHandler","fn","index","splice","push","reducers","dispatch","subscribe","getState"],"mappings":"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"}