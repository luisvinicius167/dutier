!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.Dutier=t.Dutier||{})}(this,function(t){"use strict";var e={_reducers:[],_handlers:[],_middlewares:[],_updateState:function(){}},n=function(t){return function(t){return function(e){return t=Object.assign({},t,e),JSON.parse(JSON.stringify(t))}}(t)},r=function(t){void 0===e._updateState({})&&(e._updateState=n({})),t.forEach(function(t){var n=t(void 0,{type:"@@DUTIER.INITIAL_STATE"}),r=e._reducers.length;e._reducers[r]={reducer:t,initial:n},e._updateState(n)})},a=function(t){return new Promise(function(n){e._reducers.forEach(function(r){var a=r.reducer,i=r.initial,o=a.current?e._updateState({}):i;a.current=o;var u=a(o,t),c=a(o,{action:"@@DUTIER.ACTION",payload:t.payload});if(JSON.stringify(c)!==JSON.stringify(u))return n({action:t,oldState:o,state:e._updateState(u)})})})},i=function(t){var n=t.type,r=t.state,a=t.payload;return e._handlers.forEach(function(t){void 0!==t&&"function"==typeof t&&t({type:n,state:r,payload:a})}),{type:n,state:r,payload:a}},o=function(t){return e._middlewares.forEach(function(e){return e.call(null,t)}),Promise.resolve({type:t.action.type,payload:t.action.payload,state:t.state})},u=function(t){return new Promise(function(e){return t.call(null,e)}).then(a).then(o).then(i)},c=function(){return e._updateState({})},d=function(t){e._handlers.forEach(function(n,r){n===t&&e._handlers.splice(r,1)})},f=function(t){return e._handlers.push(t),function(){d(t)}};t.applyMiddleware=function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];e._middlewares=e._middlewares.concat(n)},t.createStore=function(){for(var t=arguments.length,a=Array(t),i=0;i<t;i++)a[i]=arguments[i];return void 0===e._updateState({})&&(e._updateState=n({})),r(a),{dispatch:u,subscribe:f,getState:c}},t.combine=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];r(e)},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=dutier.min.js.map
