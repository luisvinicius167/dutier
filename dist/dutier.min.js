!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.Dutier=t.Dutier||{})}(this,function(t){"use strict";var e={_reducers:new Map,_handlers:[],_middlewares:[],_updateState:function(){}},r=function(t){return function(t){return function(e){return t=Object.assign({},t,e),JSON.parse(JSON.stringify(t))}}(t)},n=function(t){void 0===e._updateState({})&&(e._updateState=r({})),t.forEach(function(t){var r=t(void 0,{type:"@@DUTIER.INITIAL_STATE"});e._reducers.set(t,{initial:r}),e._updateState(r)})},i=function(){function t(t,e){var r=[],n=!0,i=!1,a=void 0;try{for(var u,o=t[Symbol.iterator]();!(n=(u=o.next()).done)&&(r.push(u.value),!e||r.length!==e);n=!0);}catch(t){i=!0,a=t}finally{try{!n&&o.return&&o.return()}finally{if(i)throw a}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(t){return new Promise(function(r){var n=!0,a=!1,u=void 0;try{for(var o,c=e._reducers[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var f=o.value,d=i(f,2),l=d[0],s=d[1],p=s.current?s.current:s.initial,y=s.current=l(p,t),h=l(p,{type:"@@Dutier.OLD_STATE",value:t.value}),_=Object.assign({},e._updateState({}),h);if(JSON.stringify(y)!==JSON.stringify(p))return r({action:t,oldState:_,state:e._updateState(y)})}}catch(t){a=!0,u=t}finally{try{!n&&c.return&&c.return()}finally{if(a)throw u}}})},u=function(t){var r=t.type,n=t.state;return e._handlers.forEach(function(t){void 0!==t&&"function"==typeof t&&t({type:r,state:n})}),{type:r,state:n}},o=function(t){return e._middlewares.forEach(function(e){return e.call(null,t)}),Promise.resolve({type:t.action.type,state:t.state})},c=function(t){return new Promise(function(e){return t.call(null,e)}).then(a).then(o).then(u)},f=function(){return e._updateState({})},d=function(t){e._handlers.forEach(function(r,n){r===t&&e._handlers.splice(n,1)})},l=function(t){return e._handlers.push(t),function(){d(t)}};t.createStore=function(){for(var t=arguments.length,i=Array(t),a=0;a<t;a++)i[a]=arguments[a];return void 0===e._updateState({})&&(e._updateState=r({})),n(i),{dispatch:c,subscribe:l,getState:f}},t.combine=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];n(e)},t.applyMiddleware=function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];e._middlewares=e._middlewares.concat(r)},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=dutier.min.js.map
